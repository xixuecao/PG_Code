 function dx = lanrange1 (t,x)
global   l R g w 
dx = zeros(4,1);    % a column vector
dx(1)=x(2);
dx(2)=-(x(1)^5*x(4)^2 - (g*x(1)^5)/(l^2 - R^2 - x(1)^2 + 2*R*x(1)*cos(x(3) - t*w))^(1/2) + R^2*x(1)*x(2)^2 + R^4*x(1)*x(4)^2 - R^3*x(2)^2*cos(x(3) - t*w) - l^2*x(1)*x(2)^2 + l^4*x(1)*x(4)^2 + 2*R^2*x(1)^3*x(4)^2 + R^3*x(2)^2*cos(x(3) - t*w)^3 - 2*l^2*x(1)^3*x(4)^2 - 2*R^2*l^2*x(1)*x(4)^2 + R^3*w^2*x(1)^2*cos(x(3) - t*w) - R^4*w^2*x(1)*cos(x(3) - t*w)^2 - R^2*x(1)*x(2)^2*cos(x(3) - t*w)^2 - 3*R^3*x(1)^2*x(4)^2*cos(x(3) - t*w) - R^4*x(1)*x(4)^2*cos(x(3) - t*w)^2 - R^4*x(1)*x(4)^2*sin(x(3) - t*w)^2 - (R^4*g*x(1))/(l^2 - R^2 - x(1)^2 + 2*R*x(1)*cos(x(3) - t*w))^(1/2) + (R^5*g*cos(x(3) - t*w))/(l^2 - R^2 - x(1)^2 + 2*R*x(1)*cos(x(3) - t*w))^(1/2) - (g*l^4*x(1))/(l^2 - R^2 - x(1)^2 + 2*R*x(1)*cos(x(3) - t*w))^(1/2) - 3*R^2*w^2*x(1)^3*cos(x(3) - t*w)^2 + 2*R^3*w^2*x(1)^2*cos(x(3) - t*w)^3 + R^2*x(1)^3*x(4)^2*cos(x(3) - t*w)^2 + 2*R^3*x(1)^2*x(4)^2*cos(x(3) - t*w)^3 - R^2*w^2*x(1)^3*sin(x(3) - t*w)^2 - 2*R^2*x(1)^3*x(4)^2*sin(x(3) - t*w)^2 - (2*R^2*g*x(1)^3)/(l^2 - R^2 - x(1)^2 + 2*R*x(1)*cos(x(3) - t*w))^(1/2) + R*l^2*x(2)^2*cos(x(3) - t*w) + R*w^2*x(1)^4*cos(x(3) - t*w) - 3*R*x(1)^4*x(4)^2*cos(x(3) - t*w) + (2*g*l^2*x(1)^3)/(l^2 - R^2 - x(1)^2 + 2*R*x(1)*cos(x(3) - t*w))^(1/2) - 2*R^3*w*x(1)*x(2)*sin(x(3) - t*w) - 2*R*x(1)^3*x(2)*x(4)*sin(x(3) - t*w) + R^2*l^2*w^2*x(1)*cos(x(3) - t*w)^2 + R^2*l^2*x(1)*x(4)^2*cos(x(3) - t*w)^2 + 2*R^4*w*x(2)*cos(x(3) - t*w)*sin(x(3) - t*w) + R^2*l^2*x(1)*x(4)^2*sin(x(3) - t*w)^2 + R^3*w^2*x(1)^2*cos(x(3) - t*w)*sin(x(3) - t*w)^2 + 3*R^3*x(1)^2*x(4)^2*cos(x(3) - t*w)*sin(x(3) - t*w)^2 + (2*R^2*g*l^2*x(1))/(l^2 - R^2 - x(1)^2 + 2*R*x(1)*cos(x(3) - t*w))^(1/2) - (2*R^3*g*l^2*cos(x(3) - t*w))/(l^2 - R^2 - x(1)^2 + 2*R*x(1)*cos(x(3) - t*w))^(1/2) + (6*R^3*g*x(1)^2*cos(x(3) - t*w))/(l^2 - R^2 - x(1)^2 + 2*R*x(1)*cos(x(3) - t*w))^(1/2) - (4*R^4*g*x(1)*cos(x(3) - t*w)^2)/(l^2 - R^2 - x(1)^2 + 2*R*x(1)*cos(x(3) - t*w))^(1/2) - 2*R^3*w*x(1)^2*x(4)*cos(x(3) - t*w) + 2*R^4*w*x(1)*x(4)*cos(x(3) - t*w)^2 - R*l^2*w^2*x(1)^2*cos(x(3) - t*w) + 3*R*l^2*x(1)^2*x(4)^2*cos(x(3) - t*w) - (8*R^2*g*x(1)^3*cos(x(3) - t*w)^2)/(l^2 - R^2 - x(1)^2 + 2*R*x(1)*cos(x(3) - t*w))^(1/2) + (4*R^3*g*x(1)^2*cos(x(3) - t*w)^3)/(l^2 - R^2 - x(1)^2 + 2*R*x(1)*cos(x(3) - t*w))^(1/2) + 6*R^2*w*x(1)^3*x(4)*cos(x(3) - t*w)^2 - 4*R^3*w*x(1)^2*x(4)*cos(x(3) - t*w)^3 + 2*R^2*w*x(1)^3*x(4)*sin(x(3) - t*w)^2 + (R*g*l^4*cos(x(3) - t*w))/(l^2 - R^2 - x(1)^2 + 2*R*x(1)*cos(x(3) - t*w))^(1/2) + (5*R*g*x(1)^4*cos(x(3) - t*w))/(l^2 - R^2 - x(1)^2 + 2*R*x(1)*cos(x(3) - t*w))^(1/2) - 2*R*w*x(1)^4*x(4)*cos(x(3) - t*w) + (4*R^2*g*l^2*x(1)*cos(x(3) - t*w)^2)/(l^2 - R^2 - x(1)^2 + 2*R*x(1)*cos(x(3) - t*w))^(1/2) - 2*R^2*l^2*w*x(1)*x(4)*cos(x(3) - t*w)^2 - 2*R^3*w*x(1)^2*x(4)*cos(x(3) - t*w)*sin(x(3) - t*w)^2 + 2*R*l^2*w*x(1)*x(2)*sin(x(3) - t*w) - (6*R*g*l^2*x(1)^2*cos(x(3) - t*w))/(l^2 - R^2 - x(1)^2 + 2*R*x(1)*cos(x(3) - t*w))^(1/2) + 2*R*l^2*w*x(1)^2*x(4)*cos(x(3) - t*w) - 2*R^2*l^2*w*x(2)*cos(x(3) - t*w)*sin(x(3) - t*w) + 2*R^2*w*x(1)^2*x(2)*cos(x(3) - t*w)*sin(x(3) - t*w) - 2*R^3*w*x(1)*x(2)*cos(x(3) - t*w)^2*sin(x(3) - t*w) + 4*R^2*x(1)^2*x(2)*x(4)*cos(x(3) - t*w)*sin(x(3) - t*w) - 2*R^3*x(1)*x(2)*x(4)*cos(x(3) - t*w)^2*sin(x(3) - t*w))/((R^2*sin(x(3) - t*w)^2 - R^2 + l^2 + R^2*cos(x(3) - t*w)^2)*(R^2 - 2*x(1)*cos(x(3) - t*w)*R - l^2 + x(1)^2));
dx(3)=x(4);
dx(4)=(2*R^4*x(2)*x(4) + 2*l^4*x(2)*x(4) - R^3*x(2)^2*sin(x(3) - t*w) - R^3*x(1)^2*x(4)^2*sin(x(3) - t*w) + R^3*x(2)^2*cos(x(3) - t*w)^2*sin(x(3) - t*w) + (R^5*g*sin(x(3) - t*w))/(l^2 - R^2 - x(1)^2 + 2*R*x(1)*cos(x(3) - t*w))^(1/2) + R^3*w^2*x(1)^2*sin(x(3) - t*w)^3 + R^3*x(1)^2*x(4)^2*sin(x(3) - t*w)^3 - 4*R^2*l^2*x(2)*x(4) + 2*R^2*x(1)^2*x(2)*x(4) - 2*R^4*x(2)*x(4)*cos(x(3) - t*w)^2 + R*l^2*x(2)^2*sin(x(3) - t*w) - 2*l^2*x(1)^2*x(2)*x(4) + 2*R^4*w*x(2)*sin(x(3) - t*w)^2 - R*x(1)^4*x(4)^2*sin(x(3) - t*w) - 2*R^4*x(2)*x(4)*sin(x(3) - t*w)^2 + (R*g*x(1)^4*sin(x(3) - t*w))/(l^2 - R^2 - x(1)^2 + 2*R*x(1)*cos(x(3) - t*w))^(1/2) + 2*R^3*w^2*x(1)^2*cos(x(3) - t*w)^2*sin(x(3) - t*w) - (2*R^3*g*l^2*sin(x(3) - t*w))/(l^2 - R^2 - x(1)^2 + 2*R*x(1)*cos(x(3) - t*w))^(1/2) + 4*R^3*x(1)*x(2)*x(4)*cos(x(3) - t*w)^3 + (2*R^3*g*x(1)^2*sin(x(3) - t*w))/(l^2 - R^2 - x(1)^2 + 2*R*x(1)*cos(x(3) - t*w))^(1/2) - R^4*w^2*x(1)*cos(x(3) - t*w)*sin(x(3) - t*w) + 2*R^2*l^2*x(2)*x(4)*cos(x(3) - t*w)^2 - 2*R^2*x(1)^2*x(2)*x(4)*cos(x(3) - t*w)^2 - 2*R^2*l^2*w*x(2)*sin(x(3) - t*w)^2 + R*l^2*x(1)^2*x(4)^2*sin(x(3) - t*w) + 2*R^2*l^2*x(2)*x(4)*sin(x(3) - t*w)^2 - 2*R^3*w*x(1)^2*x(4)*sin(x(3) - t*w)^3 - R^2*w^2*x(1)^3*cos(x(3) - t*w)*sin(x(3) - t*w) + 2*R^2*x(1)^3*x(4)^2*cos(x(3) - t*w)*sin(x(3) - t*w) + (R*g*l^4*sin(x(3) - t*w))/(l^2 - R^2 - x(1)^2 + 2*R*x(1)*cos(x(3) - t*w))^(1/2) - 4*R^3*x(1)*x(2)*x(4)*cos(x(3) - t*w) + R^2*l^2*w^2*x(1)*cos(x(3) - t*w)*sin(x(3) - t*w) + (4*R^3*g*x(1)^2*cos(x(3) - t*w)^2*sin(x(3) - t*w))/(l^2 - R^2 - x(1)^2 + 2*R*x(1)*cos(x(3) - t*w))^(1/2) - 4*R^3*w*x(1)^2*x(4)*cos(x(3) - t*w)^2*sin(x(3) - t*w) + 4*R*l^2*x(1)*x(2)*x(4)*cos(x(3) - t*w) - (4*R^4*g*x(1)*cos(x(3) - t*w)*sin(x(3) - t*w))/(l^2 - R^2 - x(1)^2 + 2*R*x(1)*cos(x(3) - t*w))^(1/2) + 2*R^4*w*x(1)*x(4)*cos(x(3) - t*w)*sin(x(3) - t*w) - (2*R*g*l^2*x(1)^2*sin(x(3) - t*w))/(l^2 - R^2 - x(1)^2 + 2*R*x(1)*cos(x(3) - t*w))^(1/2) - (4*R^2*g*x(1)^3*cos(x(3) - t*w)*sin(x(3) - t*w))/(l^2 - R^2 - x(1)^2 + 2*R*x(1)*cos(x(3) - t*w))^(1/2) - 2*R^3*w*x(1)*x(2)*cos(x(3) - t*w)*sin(x(3) - t*w)^2 + 2*R^2*w*x(1)^3*x(4)*cos(x(3) - t*w)*sin(x(3) - t*w) + 2*R^3*x(1)*x(2)*x(4)*cos(x(3) - t*w)*sin(x(3) - t*w)^2 + (4*R^2*g*l^2*x(1)*cos(x(3) - t*w)*sin(x(3) - t*w))/(l^2 - R^2 - x(1)^2 + 2*R*x(1)*cos(x(3) - t*w))^(1/2) - 2*R^2*l^2*w*x(1)*x(4)*cos(x(3) - t*w)*sin(x(3) - t*w))/(x(1)*(R^2*sin(x(3) - t*w)^2 - R^2 + l^2 + R^2*cos(x(3) - t*w)^2)*(R^2 - 2*x(1)*cos(x(3) - t*w)*R - l^2 + x(1)^2));
end